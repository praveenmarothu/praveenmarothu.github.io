var fw={Component:class{constructor(pelement,params={}){this.pelement=pelement,this.params=params,this.element=document.createElement("div"),this.element.style.position="relative",this.element.style.zIndex=9e3,this.element.className="fw-component",this.pelement.appendChild(this.element),this.init()}init(){}},Container:class{constructor(parent,cname=null,html=null){this.parent=parent,this.element=document.createElement("div"),this.element.style.position="relative",this.element.className="fw-container",null!=html&&(this.element.innerHTML=html),null!=cname&&this.addClass(cname),this.parent.element.appendChild(this.element),this.setSize(300,300),this.setzIndex(9e3),this.init()}init(){}addClass(cname){this.element.className+=" "+cname}removeClass(cname){re=new RegExp(" "+cname,"gi"),this.element.className=this.element.className.replace(re,"")}setSize(width,height){this.element.style.height="string"==typeof height?height:height+"px",this.element.style.width="string"==typeof width?width:width+"px"}setzIndex(zindex){this.element.style.zIndex=zindex}},Element:class{constructor(parent,cname=null,html=null){this.dragOffsetX=0,this.dragOffsetY=0,this.dragX1=0,this.dragY1=0,this.dragX2=0,this.dragY2=0,this.drag=null,this.dragStart=null,this.dragStop=null,this.parent=parent,this.element=document.createElement("div"),this.element.style.position="absolute",this.element.className="fw-element",null!=html&&(this.element.innerHTML=html),null!=cname&&this.addClass(cname),this.parent.element.appendChild(this.element),this.setSize(300,300)}addClass(cname){-1==this.element.className.indexOf(cname)&&(this.element.className+=" "+cname)}removeClass(cname){var re=new RegExp(" "+cname,"gi");this.element.className=this.element.className.replace(re,"")}setPositionLeft(left){this.element.style.left=left+"px"}setPositionTop(top){this.element.style.top=top+"px"}setPosition(left,top){this.element.style.left=left+"px",this.element.style.top=top+"px"}setSize(width,height){this.element.style.height="string"==typeof height?height:height+"px",this.element.style.width="string"==typeof width?width:width+"px"}setzIndex(zindex){this.element.style.zIndex=zindex}onDragStart(){}onDrag(left,top){}onDragStop(){}makeDraggable(){var isTouchDevice="ontouchstart"in document.documentElement;this.dragStart=evt=>{evt.preventDefault(),isTouchDevice&&(evt=evt.targetTouches[0]),this.dragOffsetX=evt.pageX-this.element.offsetLeft,this.dragOffsetY=evt.pageY-this.element.offsetTop,isTouchDevice?(document.addEventListener("touchmove",this.drag),document.addEventListener("touchend",this.dragStop)):(document.addEventListener("mousemove",this.drag),document.addEventListener("mouseup",this.dragStop)),this.onDragStart()},this.drag=evt=>{evt.preventDefault(),isTouchDevice&&(evt=evt.targetTouches[0]);var left=evt.pageX-this.dragOffsetX,top=evt.pageY-this.dragOffsetY;left>this.dragX2&&(left=this.dragX2),top>this.dragY2&&(top=this.dragY2),left<this.dragX1&&(left=this.dragX1),top<this.dragY1&&(top=this.dragY1),this.setPosition(left,top),this.onDrag(left,top)},this.dragStop=evt=>{evt.preventDefault(),isTouchDevice?(document.removeEventListener("touchmove",this.drag),document.removeEventListener("touchend",this.dragStop)):(document.removeEventListener("mousemove",this.drag),document.removeEventListener("mouseup",this.dragStop)),this.onDragStop()},this.dragStart=this.dragStart.bind(this),this.drag=this.drag.bind(this),this.dragStop=this.dragStop.bind(this),isTouchDevice?this.element.addEventListener("touchstart",this.dragStart):this.element.addEventListener("mousedown",this.dragStart),this.dragX1=0,this.dragY1=0,this.dragX2=this.parent.element.offsetWidth-this.element.offsetWidth,this.dragY2=this.parent.element.offsetHeight-this.element.offsetHeight}setDraggableArea(x1,y1,x2,y2){this.dragX1=x1,this.dragY1=y1,this.dragX2=x2,this.dragY2=y2}}},shelf={};shelf.Component=class extends fw.Component{init(){this.params=Object.assign({},shelf.params,this.params);var pc=new fw.Container(this,"shelf-container");pc.setSize(840,480),this.initShelf(pc)}initShelf(pc){var row=0,col=0,popup=new shelf.Popup(pc,"shelf-popup");popup.element.style.width="",popup.element.style.height="",popup.element.style.left="",popup.element.style.top="";for(var i=0;i<this.params.items.length;i++){(item=new shelf.Item(pc,"shelf-item")).init(this.params.items[i],popup),item.setSize(100,100),item.setPosition(20+100*col,20+110*row),++col==this.params.cols&&(col=0,row++)}for(console.log(col,this.params.cols);col!=this.params.cols;){var item;(item=new shelf.Item(pc,"shelf-item")).init(null),item.setSize(100,100),item.setPosition(20+100*col,20+110*row),col++}}},shelf.params={cols:8,items:[{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"},{image:"img.jpeg",weight:"128oz",price:"$6.99",selected:"0"}]},shelf.Item=class extends fw.Element{init(iparams,popup){this.iparams=iparams,null!=iparams?(this.element.innerHTML=`\n\n        <i class="status fas fa-check"></i>\n        <div class="imgpane" style="background-image:url('${iparams.image}');position:absolute;left:0px;top:0px;width:100%;height:calc(100% - 20px)"></div>\n        <div class="hover" style="position:absolute;left:0px;top:0px;width:100%;height:calc(100% - 20px)"></div>\n        <div class="infopane" style="position:absolute;left:0px;bottom:0px;width:100%;height:20px;">${iparams.weight}&nbsp;&nbsp;${iparams.price}</div>\n        \n        `,this.popup=popup,"1"==iparams.selected&&this.addClass("selected"),this.onClick=evt=>{popup.show(this)},this.element.addEventListener("click",this.onClick)):this.element.innerHTML='\n            <div class="infopane" style="position:absolute;left:0px;bottom:0px;width:100%;height:20px;"></div>        \n            '}},shelf.Popup=class extends fw.Element{init(){}show(item){var iparams=item.iparams;this.element.innerHTML=`\n        <i class="status fas fa-check"></i>\n        <div class="imgpane" style="background-image:url('${iparams.image}');position:absolute;left:25%;top:5%;width:50%;height:calc(90% - 40px)">\n            <i class="close fas fa-times"></i>\n        </div>\n        <div class="select">BUY</div>\n        <div class="clear">CLEAR</div>     \n        <div class="infopane" style="position:absolute;left:25%;bottom:5%;width:50%;height:40px;">${iparams.weight}&nbsp;&nbsp;${iparams.price}</div>\n        `,"1"==iparams.selected?this.addClass("selected"):this.removeClass("selected"),this.addClass("visible"),this.element.querySelector(".close").addEventListener("click",(evt=>{this.removeClass("visible")})),this.element.querySelector(".select").addEventListener("click",(evt=>{evt.preventDefault(),evt.stopPropagation(),this.addClass("selected"),item.addClass("selected")})),this.element.querySelector(".clear").addEventListener("click",(evt=>{evt.preventDefault(),evt.stopPropagation(),this.removeClass("selected"),item.removeClass("selected")}))}};
